# V9.18 - Testing Checklist ‚úÖ

## üìã Automated Testing

### Test File: test_ranking_arrows_equals.html

**Status:** ‚úÖ Created

**Coverage:**
- [x] Tied position calculation logic
- [x] Ranking progression with ties (1, 2, 2, 4 format)
- [x] Arrow symbol display (üîº, üîΩ, =)
- [x] Complex scenarios with multiple tied positions
- [x] Visual representation of before/after

**How to Run:**
1. Open `test_ranking_arrows_equals.html` in a web browser
2. Review the visual examples
3. Check the logic test results (should all be ‚úì)

---

## üß™ Manual Testing Checklist

### Part 1: Riepilogo Totale (Total Summary)

#### Initial Setup
- [ ] Open `index.html` in a web browser
- [ ] Navigate to the main page (after login)
- [ ] Ensure you have convocation data loaded

#### Test Scenarios

**Scenario 1: First Time (No Previous Data)**
- [ ] Clear localStorage: `localStorage.removeItem('lastWeekRanking')`
- [ ] Reload page
- [ ] Expected: No arrows/symbols appear (first time)
- [ ] Verify: Check console for "Updated weekly ranking snapshot" message

**Scenario 2: Players with Same Values (Tied Positions)**
- [ ] Look for players with identical presences AND availability %
- [ ] Expected: They should have the same rank number
- [ ] Example: If two players both have "12 presences, 90%", both should show same rank

**Scenario 3: Unchanged Position (Equals Symbol)**
- [ ] Simulate second week by modifying localStorage:
```javascript
// Get current ranking
const current = JSON.parse(localStorage.getItem('lastWeekRanking'));
// Set it as "last week" with old date
current.date = new Date(Date.now() - 8 * 24 * 60 * 60 * 1000).toISOString();
localStorage.setItem('lastWeekRanking', JSON.stringify(current));
// Now reload - should see "=" for unchanged positions
```
- [ ] Expected: Players maintaining same rank show "=" symbol in gray

**Scenario 4: Position Changes**
- [ ] Modify test data to change player positions
- [ ] Expected: üîº for improved position, üîΩ for declined position

#### Verification Points
- [ ] Ranking shows tied positions correctly (e.g., 1, 2, 2, 4)
- [ ] "=" symbol appears in gray (#6b7280) for unchanged positions
- [ ] üîº appears in green for improvements
- [ ] üîΩ appears in red for declines
- [ ] localStorage contains `lastWeekRanking` with correct structure

---

### Part 2: Report Presenze Allenamenti (Training Attendance Report)

#### Initial Setup
- [ ] Navigate to "Gestione Allenamenti" (Training Management)
- [ ] Click on "Report Presenze" or equivalent
- [ ] Ensure training data is loaded

#### Test Scenarios

**Scenario 1: First Time (No Previous Data)**
- [ ] Clear localStorage: `localStorage.removeItem('lastWeekRankingTraining')`
- [ ] Reload page
- [ ] Expected: No arrows/symbols appear (first time)
- [ ] Verify: Check console for "Updated weekly training ranking snapshot" message

**Scenario 2: Tied Positions in Training**
- [ ] Look for players with identical training presences AND availability %
- [ ] Expected: They should have the same rank number
- [ ] Example: Two players both with "10 presences, 85%" should share same rank

**Scenario 3: Unchanged Position with Equals Symbol**
- [ ] Use same technique as Riepilogo Totale but with 'lastWeekRankingTraining'
```javascript
const current = JSON.parse(localStorage.getItem('lastWeekRankingTraining'));
current.date = new Date(Date.now() - 8 * 24 * 60 * 60 * 1000).toISOString();
localStorage.setItem('lastWeekRankingTraining', JSON.stringify(current));
```
- [ ] Expected: "=" symbol for unchanged positions

#### Verification Points
- [ ] Training report shows tied positions correctly
- [ ] "=" symbol appears for unchanged positions
- [ ] Arrows work consistently with Riepilogo Totale
- [ ] localStorage contains `lastWeekRankingTraining` with correct structure

---

## üîç Edge Cases Testing

### Edge Case 1: All Players Tied
**Setup:** All players have same presences and availability
- [ ] Expected: All players show rank 1
- [ ] Expected: On subsequent week, all show "=" if values unchanged

### Edge Case 2: Long Tie Chain
**Setup:** Multiple groups of tied players (e.g., 1, 2, 2, 2, 5, 6, 6, 8)
- [ ] Expected: Ranking skips correctly after ties
- [ ] Expected: Each tied group shares same rank

### Edge Case 3: New Player Appears
**Setup:** Add a new player who wasn't in last week's data
- [ ] Expected: No arrow/symbol (no previous data for this player)
- [ ] Expected: Other players' arrows still work correctly

### Edge Case 4: Player Disappears
**Setup:** Remove a player from current week
- [ ] Expected: Other players' rankings adjust correctly
- [ ] Expected: Arrows reflect actual position changes

### Edge Case 5: Availability Data Missing
**Setup:** Company without availability data (not POLIS)
- [ ] Expected: Sorting works (by presences only)
- [ ] Expected: Ties only on presences (availability = -1 for all)
- [ ] Expected: Arrows still work correctly

---

## üé® Visual Testing

### Symbol Appearance

**Green Arrow (üîº)**
- [ ] Color is clearly green (#22c55e)
- [ ] Easily distinguishable from text
- [ ] Aligned properly with presences number

**Red Arrow (üîΩ)**
- [ ] Color is clearly red (#ef4444)
- [ ] Easily distinguishable from text
- [ ] Aligned properly with presences number

**Equals Symbol (=)**
- [ ] Color is clearly gray (#6b7280)
- [ ] Easily distinguishable from green/red
- [ ] Not confused with dash or minus sign
- [ ] Aligned properly with presences number

### Spacing and Layout
- [ ] Arrows/symbols don't break table layout
- [ ] Mobile view displays correctly
- [ ] Desktop view displays correctly
- [ ] Text remains readable with symbols

---

## üß© Integration Testing

### Cross-Section Consistency
- [ ] Riepilogo Totale and Report Presenze use same logic
- [ ] Both sections handle tied positions identically
- [ ] Both sections show "=" for unchanged positions
- [ ] Symbol colors are consistent across sections

### LocalStorage Persistence
- [ ] Data persists across page reloads
- [ ] Separate storage keys don't interfere:
  - `lastWeekRanking` vs `lastWeekRankingTraining`
  - `lastRankingUpdate` vs `lastRankingUpdateTraining`
- [ ] Weekly auto-update works (Monday or 7+ days)

### Performance
- [ ] Page loads quickly with new logic
- [ ] No visible lag when rendering arrows
- [ ] Console shows no errors
- [ ] Large player lists (20+) render correctly

---

## üì± Device Testing

### Desktop Browsers
- [ ] Chrome/Chromium
- [ ] Firefox
- [ ] Safari (if available)
- [ ] Edge

### Mobile Browsers
- [ ] Mobile Chrome
- [ ] Mobile Safari
- [ ] Mobile Firefox

### Screen Sizes
- [ ] Desktop (1920x1080)
- [ ] Laptop (1366x768)
- [ ] Tablet (768x1024)
- [ ] Phone (375x667)

---

## ‚ôø Accessibility Testing

### Color Contrast
- [ ] Green arrow visible to colorblind users
- [ ] Red arrow visible to colorblind users
- [ ] Gray equals symbol readable
- [ ] Sufficient contrast ratios (WCAG AA)

### Screen Reader
- [ ] Symbols announced properly
- [ ] Table structure navigable
- [ ] Ranking changes understandable without visual

---

## üîß Developer Testing

### Code Quality
- [ ] No JavaScript errors in console
- [ ] No warnings in console
- [ ] HTML validates correctly
- [ ] Consistent indentation and formatting

### Backward Compatibility
- [ ] Old localStorage data doesn't break new code
- [ ] New code works without existing localStorage
- [ ] Version upgrade smooth (V9.17 ‚Üí V9.18)

### Documentation
- [ ] All documentation files created
- [ ] Examples in docs match actual behavior
- [ ] Code comments accurate and helpful

---

## üìä Regression Testing

### Verify Existing Features Still Work
- [ ] Convocations still create correctly
- [ ] Player selection still works
- [ ] PDF generation still works
- [ ] Other V9.17 features unchanged
- [ ] Availability data loading works
- [ ] Firebase integration intact

---

## ‚úÖ Sign-Off Checklist

Before marking as complete, ensure:
- [ ] All automated tests pass
- [ ] All manual test scenarios completed
- [ ] All edge cases tested
- [ ] Visual testing satisfactory
- [ ] Integration testing complete
- [ ] Device testing on at least 2 browsers
- [ ] Accessibility basic checks done
- [ ] Developer testing complete
- [ ] Regression testing shows no breaks
- [ ] Documentation reviewed and accurate

---

## üêõ Known Issues / Limitations

Document any issues found during testing:

**Issue 1:** _[None found yet]_
- **Description:**
- **Severity:**
- **Workaround:**
- **Fix planned:**

---

## üìù Test Results Summary

**Date:** _[Fill in when testing complete]_  
**Tester:** _[Name]_  
**Version:** V9.18  

**Results:**
- Total Tests: [X]
- Passed: [X]
- Failed: [X]
- Skipped: [X]

**Overall Status:** [ ] PASS / [ ] FAIL / [ ] NEEDS REVIEW

**Notes:**
_[Additional comments]_

---

## üéØ Next Steps After Testing

If all tests pass:
1. Mark PR as ready for review
2. Request code review from team
3. Merge to main branch
4. Deploy to production
5. Monitor for issues

If issues found:
1. Document issues above
2. Create fix commits
3. Re-test affected areas
4. Update documentation if needed
