<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Timestamp Improvements</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">
    <div class="container mx-auto max-w-4xl">
        <h1 class="text-3xl font-bold text-gray-800 mb-6">‚úÖ Timestamp Display Improvements</h1>

        <!-- Overview -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">üìã Changes Overview</h2>
            <div class="space-y-3">
                <div class="flex items-start">
                    <span class="text-2xl mr-3">1Ô∏è‚É£</span>
                    <div>
                        <h3 class="font-bold text-lg">Notes Timestamp Position</h3>
                        <p class="text-gray-600">Moved "Ultimo salvataggio" timestamp from <strong>above</strong> to <strong>below</strong> the "Note (Segnate dal Dirigente)" heading</p>
                    </div>
                </div>
                <div class="flex items-start">
                    <span class="text-2xl mr-3">2Ô∏è‚É£</span>
                    <div>
                        <h3 class="font-bold text-lg">New Unavailability Timestamp</h3>
                        <p class="text-gray-600">Added new "Ultimo salvataggio indisponibilit√†" timestamp below "Giocatori che hai segnato come non disponibili" heading</p>
                    </div>
                </div>
                <div class="flex items-start">
                    <span class="text-2xl mr-3">3Ô∏è‚É£</span>
                    <div>
                        <h3 class="font-bold text-lg">Dirigente Only</h3>
                        <p class="text-gray-600">Both timestamps are only visible to Dirigente role, hidden from Mister</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Role Switcher -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">üë§ Switch Role</h2>
            <div class="grid grid-cols-2 gap-4">
                <button id="btn-mister" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition">
                    Mister View
                </button>
                <button id="btn-dirigente" class="bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg transition">
                    Dirigente View
                </button>
            </div>
        </div>

        <!-- Mister View -->
        <div id="mister-view" class="hidden space-y-6">
            <h3 class="text-2xl font-bold text-blue-700">üë®‚Äçüíº Mister View</h3>
            
            <!-- Reset Timestamp (visible to both) -->
            <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-700">
                    <span class="font-semibold">üîÑ Ultimo reset indisponibilit√†:</span>
                    <span class="ml-1">domenica 5 gennaio 2025, 00:00</span>
                </p>
            </div>

            <!-- NO Last Save Timestamp for Notes (Mister) -->
            
            <!-- Notes Section -->
            <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <h3 class="text-lg font-semibold text-yellow-800 mb-2">Note (Segnate dal Dirigente)</h3>
                <!-- NO timestamp shown here for Mister -->
                <div class="p-3 bg-white border border-yellow-300 rounded-lg min-h-[80px] text-gray-700">
                    <p>Esempio di note del dirigente visibili al mister ma non editabili</p>
                </div>
            </div>

            <!-- Unavailable Players List -->
            <div class="bg-red-100 p-4 rounded-xl shadow-sm border border-red-200">
                <h2 class="text-lg font-semibold text-red-700 mb-2">Giocatori Non Disponibili (Segnalati dal Dirigente)</h2>
                <!-- NO timestamp shown here for Mister -->
                <ul class="space-y-1 text-red-600">
                    <li class="font-medium">‚Ä¢ <strong class="font-bold">ROSSI MARIO</strong>: Infortunato</li>
                    <li class="font-medium">‚Ä¢ <strong class="font-bold">VERDI GIUSEPPE</strong>: N.D. W.E.</li>
                </ul>
            </div>

            <div class="bg-blue-100 border-l-4 border-blue-500 p-4 rounded">
                <p class="text-blue-700 font-semibold">‚ÑπÔ∏è Note:</p>
                <p class="text-blue-600">As Mister, you don't see the save timestamps. These are only visible to Dirigente.</p>
            </div>
        </div>

        <!-- Dirigente View -->
        <div id="dirigente-view" class="hidden space-y-6">
            <h3 class="text-2xl font-bold text-orange-700">üëî Dirigente View</h3>
            
            <!-- Reset Timestamp -->
            <div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                <p class="text-sm text-blue-700">
                    <span class="font-semibold">üîÑ Ultimo reset indisponibilit√†:</span>
                    <span class="ml-1">domenica 5 gennaio 2025, 00:00</span>
                </p>
            </div>

            <!-- Notes Section with NEW timestamp position -->
            <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <h3 class="text-lg font-semibold text-yellow-800 mb-2">Note (Segnate dal Dirigente)</h3>
                
                <!-- ‚≠ê NEW: Timestamp NOW BELOW the heading (was above before) -->
                <div class="mb-3 p-3 bg-green-50 border border-green-200 rounded-lg">
                    <p class="text-sm text-green-700">
                        <span class="font-semibold">üíæ Ultimo salvataggio:</span>
                        <span class="ml-1">gioved√¨ 9 gennaio 2025, 15:42</span>
                    </p>
                </div>

                <textarea placeholder="Inserisci le tue note qui..." class="w-full p-3 border border-yellow-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-500" rows="3">Esempio di note editabili dal dirigente</textarea>
                <button class="mt-2 bg-yellow-600 hover:bg-yellow-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                    Salva Note
                </button>
            </div>

            <!-- Unavailable Players List with NEW timestamp -->
            <div class="bg-red-100 p-4 rounded-xl shadow-sm border border-red-200">
                <h2 class="text-lg font-semibold text-red-700 mb-2">Giocatori che hai segnato come non disponibili</h2>
                
                <!-- ‚≠ê NEW: Timestamp for unavailability saves -->
                <div class="mb-3 p-3 bg-green-50 border border-green-200 rounded-lg">
                    <p class="text-sm text-green-700">
                        <span class="font-semibold">üíæ Ultimo salvataggio indisponibilit√†:</span>
                        <span class="ml-1">gioved√¨ 9 gennaio 2025, 16:15</span>
                    </p>
                </div>

                <ul class="space-y-1 text-red-600">
                    <li class="font-medium">‚Ä¢ <strong class="font-bold">ROSSI MARIO</strong>: Infortunato</li>
                    <li class="font-medium">‚Ä¢ <strong class="font-bold">VERDI GIUSEPPE</strong>: N.D. W.E.</li>
                    <li class="font-medium">‚Ä¢ <strong class="font-bold">BIANCHI LUCA</strong>: Squalificato, N.D. W.E.</li>
                </ul>
            </div>

            <div class="bg-green-100 border-l-4 border-green-500 p-4 rounded">
                <p class="text-green-700 font-semibold">‚úÖ Improvements:</p>
                <ul class="text-green-600 space-y-1 mt-2">
                    <li>‚Ä¢ Timestamp for notes now appears <strong>below</strong> the heading (better position)</li>
                    <li>‚Ä¢ New timestamp shows when unavailability was last saved</li>
                    <li>‚Ä¢ Both timestamps update automatically when you save</li>
                </ul>
            </div>
        </div>

        <!-- Implementation Details -->
        <div class="bg-gray-800 text-white rounded-xl p-6 mb-6">
            <h2 class="text-xl font-bold mb-4">üîß Implementation Details</h2>
            
            <div class="space-y-4">
                <div class="border-l-4 border-green-500 pl-4">
                    <h3 class="font-bold text-green-400 mb-2">1. HTML Changes</h3>
                    <ul class="text-sm text-gray-300 space-y-1">
                        <li>‚Ä¢ Moved <code>last-save-timestamp-display</code> from outside to inside <code>notes-section</code></li>
                        <li>‚Ä¢ Added new <code>unavailability-save-timestamp-display</code> inside <code>unavailable-players-view</code></li>
                        <li>‚Ä¢ Both positioned right after their respective section headings</li>
                    </ul>
                </div>

                <div class="border-l-4 border-blue-500 pl-4">
                    <h3 class="font-bold text-blue-400 mb-2">2. JavaScript Changes</h3>
                    <ul class="text-sm text-gray-300 space-y-1">
                        <li>‚Ä¢ Added <code>unavailabilitySaveTimestampDisplay</code> and <code>unavailabilitySaveTimestampText</code> DOM references</li>
                        <li>‚Ä¢ Created <code>updateUnavailabilitySaveTimestampDisplay()</code> function</li>
                        <li>‚Ä¢ Updated <code>saveData()</code> to save <code>lastSaved</code> timestamp for unavailability</li>
                        <li>‚Ä¢ Updated availability snapshot listener to load and display timestamp</li>
                        <li>‚Ä¢ Added visibility logic for both timestamps based on role (show for dirigente only)</li>
                    </ul>
                </div>

                <div class="border-l-4 border-purple-500 pl-4">
                    <h3 class="font-bold text-purple-400 mb-2">3. Files Modified</h3>
                    <ul class="text-sm text-gray-300 space-y-1">
                        <li>‚Ä¢ <code>index.html</code> - Main application file</li>
                        <li>‚Ä¢ <code>index_backup.html</code> - Backup file (same changes)</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Before/After Comparison -->
        <div class="bg-white rounded-xl shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">üìä Before/After Comparison</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h3 class="font-bold text-red-600 mb-3">‚ùå Before (V9.50)</h3>
                    <div class="space-y-3 text-sm">
                        <div class="p-3 bg-gray-50 border border-gray-200 rounded">
                            <p class="font-semibold">Structure:</p>
                            <ol class="mt-2 space-y-1 pl-4 text-gray-600">
                                <li>1. Ultimo reset indisponibilit√†</li>
                                <li>2. <strong>Ultimo salvataggio (notes)</strong></li>
                                <li>3. Note (Segnate dal Dirigente)</li>
                                <li>4. Giocatori non disponibili</li>
                            </ol>
                        </div>
                        <div class="p-3 bg-red-50 border border-red-200 rounded">
                            <p class="text-red-700"><strong>Issues:</strong></p>
                            <ul class="mt-2 space-y-1 pl-4 text-red-600 list-disc">
                                <li>Notes timestamp was above heading (confusing)</li>
                                <li>No timestamp for unavailability saves</li>
                                <li>User didn't know when unavailability was last updated</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="font-bold text-green-600 mb-3">‚úÖ After (Current)</h3>
                    <div class="space-y-3 text-sm">
                        <div class="p-3 bg-gray-50 border border-gray-200 rounded">
                            <p class="font-semibold">Structure:</p>
                            <ol class="mt-2 space-y-1 pl-4 text-gray-600">
                                <li>1. Ultimo reset indisponibilit√†</li>
                                <li>2. Note (Segnate dal Dirigente)
                                    <ul class="pl-4 mt-1">
                                        <li>‚îî‚îÄ <strong>Ultimo salvataggio</strong></li>
                                    </ul>
                                </li>
                                <li>3. Giocatori non disponibili
                                    <ul class="pl-4 mt-1">
                                        <li>‚îî‚îÄ <strong>Ultimo salvataggio indisponibilit√†</strong></li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                        <div class="p-3 bg-green-50 border border-green-200 rounded">
                            <p class="text-green-700"><strong>Improvements:</strong></p>
                            <ul class="mt-2 space-y-1 pl-4 text-green-600 list-disc">
                                <li>Timestamps positioned logically below section headings</li>
                                <li>New timestamp for unavailability tracking</li>
                                <li>Clear visual hierarchy and context</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Technical Notes -->
        <div class="bg-yellow-50 border border-yellow-300 rounded-xl p-6">
            <h2 class="text-xl font-bold text-yellow-800 mb-4">üìù Technical Notes</h2>
            <ul class="space-y-2 text-yellow-700">
                <li>‚Ä¢ <strong>Date Format:</strong> Italian locale with weekday, date, and time (e.g., "gioved√¨ 9 gennaio 2025, 15:42")</li>
                <li>‚Ä¢ <strong>Timestamps Update:</strong> Automatically when saving notes or unavailability</li>
                <li>‚Ä¢ <strong>Firestore Fields:</strong> Both use <code>lastSaved</code> field with ISO timestamp</li>
                <li>‚Ä¢ <strong>Visibility:</strong> Hidden for Mister, shown for Dirigente when data exists</li>
                <li>‚Ä¢ <strong>Styling:</strong> Green background with border to differentiate from reset timestamp (blue)</li>
            </ul>
        </div>
    </div>

    <script>
        const misterView = document.getElementById('mister-view');
        const dirigenteView = document.getElementById('dirigente-view');
        const misterBtn = document.getElementById('btn-mister');
        const dirigenteBtn = document.getElementById('btn-dirigente');

        misterBtn.addEventListener('click', () => {
            misterView.classList.remove('hidden');
            dirigenteView.classList.add('hidden');
            misterBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            misterBtn.classList.add('bg-blue-800');
            dirigenteBtn.classList.remove('bg-orange-800');
            dirigenteBtn.classList.add('bg-orange-600', 'hover:bg-orange-700');
        });

        dirigenteBtn.addEventListener('click', () => {
            dirigenteView.classList.remove('hidden');
            misterView.classList.add('hidden');
            dirigenteBtn.classList.remove('bg-orange-600', 'hover:bg-orange-700');
            dirigenteBtn.classList.add('bg-orange-800');
            misterBtn.classList.remove('bg-blue-800');
            misterBtn.classList.add('bg-blue-600', 'hover:bg-blue-700');
        });

        // Start with Dirigente view to show the improvements
        dirigenteBtn.click();
    </script>
</body>
</html>
