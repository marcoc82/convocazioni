<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test V6.7 - Bold Player Names for Mister</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6 text-center">Test V6.7 - Bold Player Names Implementation</h1>
        
        <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
            <h2 class="text-xl font-semibold mb-4">Role Selection</h2>
            <div class="flex gap-3 mb-4">
                <button id="set-mister" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                    Set Role: Mister
                </button>
                <button id="set-dirigente" class="bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700">
                    Set Role: Dirigente
                </button>
            </div>
            <div class="p-3 bg-blue-50 rounded border border-blue-200">
                <strong>Current Role:</strong> <span id="current-role" class="font-bold text-blue-700">None</span>
            </div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-lg mb-6">
            <h2 class="text-xl font-semibold mb-4">Test Results</h2>
            <div id="test-results" class="space-y-2"></div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-xl font-semibold mb-4">Visual Preview</h2>
            
            <!-- Mister View -->
            <div id="mister-view" class="mb-6">
                <h3 class="font-semibold text-lg mb-2 text-green-700">Mister View:</h3>
                <div class="bg-red-100 p-4 rounded-xl shadow-sm border border-red-200">
                    <h4 class="text-lg font-semibold text-red-700 mb-2">Giocatori Non Disponibili (Segnalati dal Dirigente)</h4>
                    <ul id="unavailable-players-mister" class="space-y-1 text-red-600">
                        <!-- Will be populated by JavaScript -->
                    </ul>
                </div>
            </div>

            <!-- Dirigente View -->
            <div id="dirigente-view">
                <h3 class="font-semibold text-lg mb-2 text-orange-700">Dirigente View:</h3>
                <div class="bg-red-100 p-4 rounded-xl shadow-sm border border-red-200">
                    <h4 class="text-lg font-semibold text-red-700 mb-2">Giocatori che hai segnato come non disponibili</h4>
                    <ul id="unavailable-players-dirigente" class="space-y-1 text-red-600">
                        <!-- Will be populated by JavaScript -->
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        let userRole = null;
        const unavailablePlayers = new Map([
            ["10 ROSSI MARIO", "Infortunato"],
            ["5 VERDI GIUSEPPE", "Non disponibile Domenica"],
            ["22 BIANCHI LUCA", ["Squalificato", "Non disponibile Domenica"]],
            ["7 NERI FRANCESCO", "Motivi personali"]
        ]);

        function logTest(message, status = 'info') {
            const testResults = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = `p-3 rounded ${
                status === 'pass' ? 'bg-green-100 text-green-800' :
                status === 'fail' ? 'bg-red-100 text-red-800' :
                'bg-blue-100 text-blue-800'
            }`;
            div.textContent = message;
            testResults.appendChild(div);
        }

        function updateUnavailablePlayersView(listId, role) {
            const unavailablePlayersList = document.getElementById(listId);
            unavailablePlayersList.innerHTML = '';
            
            if (unavailablePlayers.size === 0) {
                unavailablePlayersList.innerHTML = '<li class="text-sm italic text-red-500">Nessuna disponibilit√† registrata.</li>';
                return;
            }
            
            unavailablePlayers.forEach((status, player) => {
                const li = document.createElement('li');
                const statusText = Array.isArray(status) ? status.join(', ') : status;
                
                // V6.7: When Mister views the list, make player names bold
                if (role === 'mister') {
                    li.innerHTML = `<strong class="font-bold">${player}</strong>: ${statusText}`;
                } else {
                    li.textContent = `${player}: ${statusText}`;
                }
                li.className = 'font-medium';
                unavailablePlayersList.appendChild(li);
            });
        }

        function runTests() {
            logTest('üß™ Starting V6.7 Tests...', 'info');
            
            // Test 1: Mister view should have bold player names
            logTest('Test 1: Checking Mister view for bold player names...', 'info');
            updateUnavailablePlayersView('unavailable-players-mister', 'mister');
            const misterItems = document.querySelectorAll('#unavailable-players-mister li');
            let allBold = true;
            misterItems.forEach(item => {
                const strong = item.querySelector('strong.font-bold');
                if (!strong) {
                    allBold = false;
                }
            });
            if (allBold && misterItems.length > 0) {
                logTest('‚úÖ Test 1 PASSED: All player names are bold in Mister view', 'pass');
            } else {
                logTest('‚ùå Test 1 FAILED: Player names are not bold in Mister view', 'fail');
            }

            // Test 2: Dirigente view should NOT have bold player names (uses textContent)
            logTest('Test 2: Checking Dirigente view should not use <strong> tags...', 'info');
            updateUnavailablePlayersView('unavailable-players-dirigente', 'dirigente');
            const dirigenteItems = document.querySelectorAll('#unavailable-players-dirigente li');
            let noBold = true;
            dirigenteItems.forEach(item => {
                const strong = item.querySelector('strong');
                if (strong) {
                    noBold = false;
                }
            });
            if (noBold && dirigenteItems.length > 0) {
                logTest('‚úÖ Test 2 PASSED: Dirigente view uses plain text (no <strong> tags)', 'pass');
            } else {
                logTest('‚ùå Test 2 FAILED: Dirigente view should not have <strong> tags', 'fail');
            }

            // Test 3: Check multi-status handling for Mister
            logTest('Test 3: Checking multi-status handling in Mister view...', 'info');
            const multiStatusItem = Array.from(misterItems).find(item => 
                item.textContent.includes('BIANCHI LUCA')
            );
            if (multiStatusItem && multiStatusItem.textContent.includes('Squalificato, Non disponibile Domenica')) {
                logTest('‚úÖ Test 3 PASSED: Multi-status correctly displayed with comma separation', 'pass');
            } else {
                logTest('‚ùå Test 3 FAILED: Multi-status not correctly displayed', 'fail');
            }

            // Test 4: Check that colon and status text are present
            logTest('Test 4: Checking format "Player Name: Status" is preserved...', 'info');
            let correctFormat = true;
            misterItems.forEach(item => {
                if (!item.textContent.includes(':')) {
                    correctFormat = false;
                }
            });
            if (correctFormat) {
                logTest('‚úÖ Test 4 PASSED: Format "Player Name: Status" is preserved', 'pass');
            } else {
                logTest('‚ùå Test 4 FAILED: Format is incorrect', 'fail');
            }

            logTest('‚úÖ All tests completed!', 'info');
        }

        // Event listeners
        document.getElementById('set-mister').addEventListener('click', () => {
            userRole = 'mister';
            document.getElementById('current-role').textContent = 'Mister';
            document.getElementById('current-role').className = 'font-bold text-green-700';
            updateUnavailablePlayersView('unavailable-players-mister', 'mister');
            logTest('Role set to Mister', 'info');
        });

        document.getElementById('set-dirigente').addEventListener('click', () => {
            userRole = 'dirigente';
            document.getElementById('current-role').textContent = 'Dirigente';
            document.getElementById('current-role').className = 'font-bold text-orange-700';
            updateUnavailablePlayersView('unavailable-players-dirigente', 'dirigente');
            logTest('Role set to Dirigente', 'info');
        });

        // Run tests on page load
        window.addEventListener('load', () => {
            runTests();
        });
    </script>
</body>
</html>
