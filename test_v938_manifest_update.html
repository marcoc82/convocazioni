<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test V9.38 - Manifest PWA con /convocazioni/</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-lg shadow-lg p-8 mb-6">
            <h1 class="text-3xl font-bold text-blue-600 mb-2">‚úÖ V9.38 - Test PWA Manifest</h1>
            <p class="text-gray-600 mb-6">Verifica aggiornamento percorsi icone con /convocazioni/</p>
            
            <!-- Version Badge -->
            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <span class="text-2xl">üéâ</span>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm font-medium text-blue-800">
                            Versione Aggiornata: <span class="font-bold">V9.38</span>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Status Summary -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                    <h3 class="font-semibold text-green-800 mb-2">‚úÖ Modifiche Completate</h3>
                    <ul class="text-sm text-green-700 space-y-1">
                        <li>‚Ä¢ Percorsi icone con /convocazioni/</li>
                        <li>‚Ä¢ Icona 512x512 configurata</li>
                        <li>‚Ä¢ Purpose "any maskable" aggiunto</li>
                        <li>‚Ä¢ Versione aggiornata a V9.38</li>
                    </ul>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h3 class="font-semibold text-blue-800 mb-2">üìã File Modificati</h3>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li>‚Ä¢ manifest.json</li>
                        <li>‚Ä¢ service-worker.js</li>
                        <li>‚Ä¢ index.html (versione + badge)</li>
                        <li>‚Ä¢ CHANGELOG_V9.38.md</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Manifest Details -->
        <div class="bg-white rounded-lg shadow-lg p-8 mb-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">üìÑ Manifest.json</h2>
            
            <!-- Before/After Comparison -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div>
                    <h3 class="text-lg font-semibold text-red-600 mb-2">‚ùå Prima (V9.37)</h3>
                    <pre class="bg-gray-900 text-gray-100 p-4 rounded-lg text-xs overflow-x-auto"><code>{
  "version": "V9.37",
  "start_url": "/convocazioni/index.html",
  "icons": [
    {
      "src": "favicon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "icon-512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}</code></pre>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-green-600 mb-2">‚úÖ Dopo (V9.38)</h3>
                    <pre class="bg-gray-900 text-gray-100 p-4 rounded-lg text-xs overflow-x-auto"><code>{
  "version": "V9.38",
  "start_url": "/convocazioni/index.html",
  "icons": [
    {
      "src": "/convocazioni/favicon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/convocazioni/icon-512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "any maskable"
    }
  ]
}</code></pre>
                </div>
            </div>

            <!-- Key Changes -->
            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4">
                <h3 class="font-semibold text-yellow-800 mb-2">üîë Modifiche Principali</h3>
                <ul class="text-sm text-yellow-700 space-y-2">
                    <li><strong>1. Percorsi Assoluti:</strong> Tutte le icone ora hanno il prefisso <code class="bg-yellow-100 px-1 rounded">/convocazioni/</code></li>
                    <li><strong>2. Purpose Maskable:</strong> Icona 512x512 ora include <code class="bg-yellow-100 px-1 rounded">"purpose": "any maskable"</code> per migliore supporto PWA</li>
                    <li><strong>3. Versione:</strong> Aggiornata da V9.37 a V9.38</li>
                </ul>
            </div>
        </div>

        <!-- Icons Preview -->
        <div class="bg-white rounded-lg shadow-lg p-8 mb-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">üé® Icone PWA</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- 192x192 Icon -->
                <div class="border border-gray-200 rounded-lg p-4">
                    <h3 class="font-semibold text-gray-700 mb-3">192x192 (Android Home Screen)</h3>
                    <div class="flex items-center justify-center bg-gray-100 p-4 rounded-lg mb-3">
                        <img src="favicon-192x192.png" alt="Icon 192x192" class="w-32 h-32">
                    </div>
                    <p class="text-sm text-gray-600">
                        <strong>Percorso:</strong><br>
                        <code class="bg-gray-100 px-2 py-1 rounded text-xs">/convocazioni/favicon-192x192.png</code>
                    </p>
                </div>

                <!-- 512x512 Icon -->
                <div class="border border-green-200 rounded-lg p-4 bg-green-50">
                    <h3 class="font-semibold text-green-700 mb-3">512x512 (Icona Principale PWA)</h3>
                    <div class="flex items-center justify-center bg-white p-4 rounded-lg mb-3">
                        <img src="icon-512.png" alt="Icon 512x512" class="w-32 h-32">
                    </div>
                    <p class="text-sm text-green-700">
                        <strong>Percorso:</strong><br>
                        <code class="bg-green-100 px-2 py-1 rounded text-xs">/convocazioni/icon-512.png</code>
                    </p>
                    <div class="mt-3 bg-green-100 p-2 rounded text-xs">
                        ‚ú® <strong>Purpose:</strong> any maskable
                    </div>
                </div>
            </div>
        </div>

        <!-- Testing Instructions -->
        <div class="bg-white rounded-lg shadow-lg p-8 mb-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">üîç Come Testare</h2>
            
            <div class="space-y-4">
                <div class="border-l-4 border-blue-500 pl-4">
                    <h3 class="font-semibold text-gray-800 mb-2">1. Verifica Manifest in Chrome DevTools</h3>
                    <ol class="text-sm text-gray-600 space-y-1 list-decimal list-inside">
                        <li>Apri l'app in Chrome/Edge</li>
                        <li>Premi F12 per aprire DevTools</li>
                        <li>Vai su <strong>Application ‚Üí Manifest</strong></li>
                        <li>Verifica che le icone mostrano <code>/convocazioni/</code></li>
                        <li>Controlla che l'icona 512x512 sia presente</li>
                    </ol>
                </div>

                <div class="border-l-4 border-green-500 pl-4">
                    <h3 class="font-semibold text-gray-800 mb-2">2. Test Installazione PWA</h3>
                    <ol class="text-sm text-gray-600 space-y-1 list-decimal list-inside">
                        <li>Clicca sull'icona di installazione nella barra degli indirizzi</li>
                        <li>L'icona 512x512 dovrebbe apparire nel dialog di installazione</li>
                        <li>Installa l'app</li>
                        <li>Verifica che l'icona dell'app installata sia 512x512</li>
                    </ol>
                </div>

                <div class="border-l-4 border-purple-500 pl-4">
                    <h3 class="font-semibold text-gray-800 mb-2">3. Verifica Service Worker</h3>
                    <ol class="text-sm text-gray-600 space-y-1 list-decimal list-inside">
                        <li>In DevTools, vai su <strong>Application ‚Üí Service Workers</strong></li>
                        <li>Verifica che la cache sia <code>polis-convocazioni-v9.38</code></li>
                        <li>Controlla che i file delle icone siano cached</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Technical Details -->
        <div class="bg-white rounded-lg shadow-lg p-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">üìö Dettagli Tecnici</h2>
            
            <div class="space-y-4">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-gray-800 mb-2">Percorsi Assoluti vs Relativi</h3>
                    <table class="w-full text-sm">
                        <tr>
                            <td class="font-semibold py-1">Prima:</td>
                            <td><code class="bg-red-100 px-2 py-1 rounded">icon-512.png</code></td>
                        </tr>
                        <tr>
                            <td class="font-semibold py-1">Dopo:</td>
                            <td><code class="bg-green-100 px-2 py-1 rounded">/convocazioni/icon-512.png</code></td>
                        </tr>
                        <tr>
                            <td class="font-semibold py-1">Beneficio:</td>
                            <td class="text-gray-600">Funziona correttamente quando l'app √® sotto <code>/convocazioni/</code></td>
                        </tr>
                    </table>
                </div>

                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-gray-800 mb-2">Purpose "any maskable"</h3>
                    <p class="text-sm text-gray-600 mb-2">
                        L'attributo <code class="bg-gray-200 px-1 rounded">purpose: "any maskable"</code> permette all'icona di:
                    </p>
                    <ul class="text-sm text-gray-600 space-y-1 list-disc list-inside">
                        <li>Essere usata come icona normale</li>
                        <li>Essere usata come icona "maskable" con safe zone</li>
                        <li>Supportare dispositivi con maschere circolari o arrotondate</li>
                    </ul>
                </div>

                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-gray-800 mb-2">Versioni Aggiornate</h3>
                    <ul class="text-sm text-gray-600 space-y-1">
                        <li><strong>manifest.json:</strong> <code class="bg-blue-100 px-2 py-1 rounded">V9.38</code></li>
                        <li><strong>service-worker.js:</strong> <code class="bg-blue-100 px-2 py-1 rounded">polis-convocazioni-v9.38</code></li>
                        <li><strong>index.html:</strong> <code class="bg-blue-100 px-2 py-1 rounded">V9.38</code> (commento + badge UI)</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="mt-8 text-center text-sm text-gray-500">
            <p>‚úÖ Test Page V9.38 - PWA Manifest Update</p>
            <p class="mt-1">Rosterkick Convocazioni - 12 Gennaio 2025</p>
        </div>
    </div>

    <script>
        // Load and display manifest.json
        fetch('manifest.json')
            .then(response => response.json())
            .then(data => {
                console.log('‚úÖ Manifest loaded successfully');
                console.log('Version:', data.version);
                console.log('Start URL:', data.start_url);
                console.log('Icons:', data.icons);
                
                // Verify icons have /convocazioni/ prefix
                const allIconsHavePrefix = data.icons.every(icon => icon.src.startsWith('/convocazioni/'));
                const has512Icon = data.icons.some(icon => icon.sizes === '512x512');
                
                if (allIconsHavePrefix && has512Icon) {
                    console.log('‚úÖ All requirements met!');
                    console.log('  - All icons have /convocazioni/ prefix');
                    console.log('  - 512x512 icon is present');
                } else {
                    console.warn('‚ö†Ô∏è Some requirements not met');
                    if (!allIconsHavePrefix) console.warn('  - Not all icons have /convocazioni/ prefix');
                    if (!has512Icon) console.warn('  - 512x512 icon not found');
                }
            })
            .catch(error => {
                console.error('‚ùå Error loading manifest:', error);
            });

        // Check service worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations()
                .then(registrations => {
                    if (registrations.length > 0) {
                        console.log('‚úÖ Service Worker registered');
                        registrations.forEach(reg => {
                            console.log('  Scope:', reg.scope);
                        });
                    } else {
                        console.log('‚ÑπÔ∏è No Service Worker registered yet');
                    }
                });
        }
    </script>
</body>
</html>
